<!DOCTYPE html>
<html>
<head>
    <title>Location Test</title>
</head>
<body>
    <h1>Location Test</h1>
    <button onclick="getLocation()">Get My Location</button>
    <p id="status">Click the button to get your location</p>
    <p id="coords"></p>
    <p id="weather"></p>
    
    <script>
        function getLocation() {
            const status = document.getElementById('status');
            const coords = document.getElementById('coords');
            
            status.textContent = "Getting location...";
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;
                        
                        status.textContent = "Location found!";
                        coords.textContent = `Latitude: ${latitude}, Longitude: ${longitude}`;
                        
                        // Fetch weather data
                        fetch(`http://localhost:8000/live-data/weather/gps/${latitude}/${longitude}`)
                            .then(response => response.json())
                            .then(data => {
                                document.getElementById('weather').textContent = 
                                    `Weather in ${data.region}: ${data.temperature}Â°C, ${data.weather_condition}`;
                            })
                            .catch(error => {
                                document.getElementById('weather').textContent = 
                                    `Error fetching weather: ${error.message}`;
                            });
                    },
                    function(error) {
                        status.textContent = "Unable to retrieve your location";
                        coords.textContent = `Error: ${error.message}`;
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 60000
                    }
                );
            } else {
                status.textContent = "Geolocation is not supported by your browser";
            }
        }
    </script>
</body>
</html>